<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Overdue Comparison Dashboard</title>

  <!-- Fonts & icons -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  
  <!-- Custom CSS -->
  <link href="style.css" rel="stylesheet">

  <!-- SheetJS -->
  <script src="libs/xlsx.full.min.js"></script>

  <!-- html2canvas -->
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

  <!-- Firebase (compat mode) -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

  <!-- Google Drive SDKs -->
  <script src="https://apis.google.com/js/api.js"></script>
  <script src="https://accounts.google.com/gsi/client" async defer></script>

</head>
<body>
  <!-- Login Container -->
  <div class="auth-container" id="loginContainer">
    <div class="auth-box">
      <h2>Welcome to Overdue Comparison</h2>
      <p>Please sign in to access the dashboard</p>
      <button class="google-btn" id="googleSignInBtn">
        <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google logo">
        Sign in with Google
      </button>
    </div>
  </div>
  
  <!-- Dashboard -->
  <div class="app-shell" id="appContainer" style="display:none">
    <header class="app-header">
      <div class="title-area">
        <span class="material-icons brand-icon">analytics</span>
        <h1>Overdue Comparison Dashboard</h1>
      </div>
      <div class="header-right">
        <div class="credits-pill" title="Remaining compares"><span id="userCredits">--</span> left</div>
        <button class="upgrade-btn" id="driveConnectBtn">Connect Drive</button>
        <button class="upgrade-btn" id="upgradeBtn" onclick="window.open('https://www.facebook.com/rezaul2000','_blank')">Upgrade</button>
        <div class="profile" id="userProfile" style="display:none;">
          <img id="userAvatar" class="avatar" src="" alt="">
          <div class="profile-info">
            <div id="userName" class="name"></div>
            <button id="logoutBtn" class="logout-link">Sign Out</button>
          </div>
        </div>
      </div>
    </header>

    <main class="app-main container">
      <div id="status" class="status info">Not connected</div>

      <section class="notice-card">
        <div class="notice-line"><span class="material-icons warn">warning</span><strong>গুরুত্বপূর্ণ:</strong> সব হিসাব আপনার কম্পিউটারেই প্রসেসিং হয়, ডেটা ইন্টারনেটে যায় না। নিরাপদে থাকুন।</div>
        <div class="notice-line"><strong>নোট:</strong> AI ভুল করতে পারে, বিলোর্স ব্যবহারকারীর আগাম মতামত গ্রহণ অনুমোদন করি।</div>
        <div class="notice-line"><strong>নতুন ফিচার:</strong> এখন Running Overdue ফাইল থেকে Person ID অনুসন্ধানী অ্যাকাউন্ট সংখ্যা ও মোট Overdue Amount দেখতে পারবেন।</div>
      </section>

      <section class="card">
        <h2>Collectible Overdue</h2>
        <div id="dropMaster" class="dropzone" data-target="masterFile">
          <span class="material-icons cloud">cloud_upload</span>
          <div>
            <div class="dz-title">Drop Collectible Overdue File here or click to upload</div>
            <div class="dz-sub" id="masterFileName">No file chosen...</div>
          </div>
          <input type="file" id="masterFile" accept=".xlsx,.xls" hidden>
        </div>
        <div class="inline-actions">
          <button id="uploadMasterBtn" class="btn btn-warning"><span class="material-icons">upload</span>Upload to Drive</button>
        </div>
      </section>

      <section class="card">
        <h2>Running Overdue</h2>
        <div id="dropDaily" class="dropzone" data-target="dailyFile">
          <span class="material-icons cloud">cloud_upload</span>
          <div>
            <div class="dz-title">Drop Running Overdue File here or click to upload</div>
            <div class="dz-sub" id="dailyFileName">No file chosen...</div>
          </div>
          <input type="file" id="dailyFile" accept=".xlsx,.xls" hidden>
        </div>
      </section>

      <section class="actions card">
        <div class="actions-row">
          <button id="compareBtn" class="btn btn-success"><span class="material-icons">play_arrow</span>Compare</button>
          <button id="downloadBtn" class="btn btn-amber"><span class="material-icons">download</span>Export XLSX</button>
          <button id="screenshotBtn" class="btn btn-teal"><span class="material-icons">photo_camera</span>Screenshot</button>
          <button id="clearBtn" class="btn btn-danger"><span class="material-icons">backspace</span>Clear</button>
        </div>
      </section>

      <section class="card">
        <h2>Result</h2>
        <div id="result"></div>
      </section>
    </main>

    <div id="loading" class="loading-overlay" style="display:none;">
      <div class="spinner"></div>
      <div>Processing...</div>
    </div>

    <div id="notificationBox" class="notification" style="display:none"></div>
  </div>

  <!-- Main Script -->
  <script src="script.js"></script>
</body>
</html>